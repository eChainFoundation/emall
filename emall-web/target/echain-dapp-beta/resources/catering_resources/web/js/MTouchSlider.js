var MTouchSlider=(function(){var p=window.Mdata||(function(){function v(z){var y=new RegExp("\\-([a-z])","g");if(!y.test(z)){return z}return z.toLowerCase().replace(y,RegExp.$1.toUpperCase())}function x(y){return y.replace(/([A-Z])/g,"-$1").toLowerCase()}function w(A,z,y){A.setAttribute("data-"+x(z),y)}function u(A,z){var y=A.getAttribute("data-"+x(z));return y||undefined}return function(B,z,y){if(arguments.length>2){try{B.dataset[v(z)]=y}catch(A){w(B,z,y)}}else{try{return B.dataset[v(z)]}catch(A){return u(B,z)}}}}()),d=window._forEach||function(u,v){Array.prototype.forEach.call(u,v)},g=navigator.userAgent,k=("createTouch" in document),t=(g.match(/iPhone|iPad|iPod/i)?true:false),j=/M030|M031|M032|MEIZU/.test(navigator.userAgent),h=/OS\s[1-4]_[0-4]/.test(g),f=(/Android\s/.test(g)||j),c=/Android\s[1-2]\.[0-2]/.test(g),b=/Android\s[1-2]\.[0-3]/.test(g),e=(/webkit/i).test(navigator.appVersion)?"webkit":(/firefox/i).test(navigator.userAgent)?"Moz":"opera" in window?"O":(/MSIE/i).test(navigator.userAgent)?"ms":"",a="WebKitCSSMatrix" in window&&"m11" in new WebKitCSSMatrix(),n="translate"+(a?"3d(":"("),l=a?",0)":")",s=function(u){return document.querySelector(u)},r=function(u){return document.querySelectorAll(u)},m=function(v,w){var x=document.createElement("canvas"),u=x.getContext("2d");if(!w){w=4}x.width=w*2;x.height=w*2;u.fillStyle=v;u.beginPath();u.arc(w,w,w,Math.PI*2,0,true);u.closePath();u.fill();p(x,"color",v);return x},q=function(){return(new Date).getTime()},o=function(w){var u=w.touches[0],x=w.currentTarget,v=x.parentNode.getClientRects()[0];return{x:u.pageX-v.left,y:u.pageY-v.top,px:u.pageX,py:u.pageY,cx:u.clientX,cy:u.clientY,sx:u.screenX,sy:u.screenY}},i=null;i=function(v,u){this._cfg=u;this._parts=v.querySelectorAll(u.pageCls||".sld_page");this._ilng=this._parts.length;if(this._ilng<2){this._parts=null;return null}this._ele=v;this._bar=v.querySelector(u.barCls||".sld_bar");this._dotCtn=v.querySelector(u.dotsCls||".sld_dots");this._dots=[];this._curr=0;this._w=this._bar.parentNode.clientWidth;this._needAuto=!!p(this._ele,"autoPlay");this._isRelLayout=!!p(this._dotCtn,"relativeLayout");this._autoItv=null;this._autoTime=p(this._ele,"autoTime")||3000;this._itvAfterTouch=null;this._drag_start={time:0,left:0,top:0,x:0,y:0,lx:0,ly:0};this._drag_end={left:0};this._directionLocked=false;this._init()};i.prototype={setWidth:function(v){this._w=v;var u=this._w;this._ele.style.width=u+"px";this._bar.style.width=this._parts.length*u+"px";d(this._parts,function(w){w.style.width=u+"px"});console.log("[MTouchSlider] fix width: "+v)},setCurrent:function(u){this._setCurr(u);this._doTransition(u,true);console.log("[MTouchSlider] current is: "+u)},fixHeight:function(u){if(typeof u=="undefined"){u=this._curr}this._ele.style.height=this._parts[u].clientHeight+"px";console.log("[MTouchSlider] fix height: "+this._ele.style.height)},_init:function(){this._ele.style.opacity=0.01;if(this._dotCtn&&this._isRelLayout){this._dotCtn.style.width=13*this._ilng+"px";this._dotCtn.style.marginLeft=0.5*(this._w-13*this._ilng)+"px"}else{this._dotCtn.style.marginLeft=0.5*(this._w-13*(this._ilng-1))+"px"}for(var v=0;v<this._ilng;v++){this._parts[v].style.width=this._w+"px";if(p(this._ele,"minHeight")){this._parts[v].style.minHeight=p(this._ele,"minHeight")+"px"}var x=m(p(this._ele,"dotColor"));this._dots[v]=x;if(this._dotCtn){if(!this._isRelLayout){this._cvs.style.left=13*v+"px"}this._dotCtn.appendChild(x)}else{x.style.top="0";x.style.left=(13*v+0.5*(this._w-13*(this._ilng-1)))+"px";this._bar.parentNode.insertAdjacentElement("afterBegin",x)}}this._bar.style.width=(this._ilng*this._w)+"px";this._ele.style.height=this._parts[0].clientHeight+"px";this._setCurr(this._curr);this._enableAuto();var w=this;this._evts={e_ts:function(y){w.e_ts.call(w,y)},e_tm:function(y){w.e_tm.call(w,y)},e_te:function(y){w.e_te.call(w,y)}};this._bar.addEventListener("touchstart",this._evts.e_ts);var u=0;if("defaultTab" in this._cfg&&this._cfg.defaultTab>0){this.setCurrent(this._cfg.defaultTab);u=500}window.setTimeout(function(){w._ele.style.opacity=1;w.fixHeight()},u)},_dragCbk:function(v){var u=p(this._ele,"dragCallback"),w=null;if(u&&window.hasOwnProperty(u)&&typeof window[u]==="function"){w=window[u];w.call(null,this._ele,this._parts[v],v)}},_enableAuto:function(){if(!this._needAuto){return}if(this._autoItv!==null){return}var v=this,w=this._bar,u=this._ilng;this._autoItv=window.setInterval(function(){var x=v._curr+1;if(x>=u){x=0}v._doTransition(x,true);v._setCurr(x);v._dragCbk(x);v.fixHeight()},v._autoTime)},_disableAuto:function(){if(!this._needAuto){return}window.clearInterval(this._autoItv);this._autoItv=null},_setCurr:function(u){this._curr=u;d(this._dots,function(w,v,x){w.style.opacity=0.4});if(this._dots[u]){this._dots[u].style.opacity=1}this._dragCbk(this._curr)},_doTransition:function(w,u){var x=u?-w*this._w:w,v=u?6.18*4*0.01:0;this._bar.style[e+"TransitionDuration"]=v+"s";this._bar.style[e+"Transform"]=n+x+"px,0"+l},e_ts:function(v){if(!k){v.preventDefault()}this._disableAuto();this._directionLocked=false;var w=o(v),u={x:this._drag_end.left*1,y:this._bar.getClientRects()[0].top};this._drag_start={time:q(),left:u.x,top:u.y,x:parseInt(u.x-w.x),y:parseInt(u.y-w.y),lx:v.touches[0].clientX,ly:v.touches[0].clientY,point:w};this._bar.addEventListener("touchmove",this._evts.e_tm);this._bar.addEventListener("touchend",this._evts.e_te);this._bar.addEventListener("touchcancel",this._evts.e_te)},e_tm:function(B){if(!k){B.preventDefault()}var A=o(B),C=B.currentTarget,z=this._drag_start.x+A.x;var y,x,w=B.touches[0].pageX-this._drag_start.point.px,u=B.touches[0].pageY-this._drag_start.point.py;if(this._directionLocked==="y"){return}else{if(this._directionLocked==="x"){B.preventDefault()}else{y=Math.abs(w);x=Math.abs(u);if(y<4){return}if(x>y*0.58){this._directionLocked="y";return}else{B.preventDefault();this._directionLocked="x"}}}this._doTransition(z);if(p(C,"touching")===undefined||p(C,"touching")*1!=1){p(C,"touching",1)}},e_te:function(x){if(!k){x.preventDefault()}this._bar.removeEventListener("touchmove",this._evts.e_tm);this._bar.removeEventListener("touchend",this._evts.e_te);this._bar.removeEventListener("touchcancel",this._evts.e_te);var z=x.currentTarget;p(z,"touching",0);try{this._drag_end.left=/\((\-?[\.\d]+)px/.exec(z.style[e+"Transform"])[1]}catch(y){}var B=this._curr,C={x:this._drag_end.left*1,y:z.getClientRects()[0].top},u=C.x,w=q()-this._drag_start.time,D=x.changedTouches[0].clientX-this._drag_start.lx,A=Math.abs(D)<5,v=w>300;if(this._directionLocked!="y"){if(!v){if(!A){if(D<0){B++}else{B--}}}else{B=Math.round(-u/this._w)}}if(B<0){B=0}if(B>=this._ilng-1){B=this._ilng-1}this._doTransition(B,true);this._drag_end.left=/\((\-?[\.\d]+)px/.exec(z.style[e+"Transform"])[1];if(B!=this._curr){this._dragCbk(B);this._setCurr(B);this._enableAuto();this.fixHeight()}}};return i}());